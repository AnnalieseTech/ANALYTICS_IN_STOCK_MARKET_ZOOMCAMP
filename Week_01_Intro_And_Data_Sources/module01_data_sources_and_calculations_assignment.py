# -*- coding: utf-8 -*-
"""Module01_Data_Sources_and_Calculations_Assignment.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1fnSsOoS8jYQyKzvA9UsmWAw_R0GQFqN5

# Module 1: Data Sources and Calculations Assignment
Objective: Download finance data from various sources and make simple calculations/analysis.


---

Setup
"""

!pip install yfinance

# Imports
import numpy as np
import pandas as pd

# Fin Data Sources
import yfinance as yf
import pandas_datareader as pdr

# Data viz
import plotly.graph_objs as go
import plotly.express as px

import matplotlib.pyplot as plt
import matplotlib.ticker as mtick

fig, ax = plt.subplots(figsize=(20, 6))
plt.grid(True)

import time
from datetime import date

"""# **Question 1: [Macro] Average growth of GDP in 2023**

What is the average growth (in %) of GDP in 2023?

Download the timeseries Real Gross Domestic Product (GDPC1) from FRED (https://fred.stlouisfed.org/series/GDPC1). Calculate year-over-year (YoY) growth rate (that is, divide current value to one 4 quarters ago). Find the average YoY growth in 2023 (average from 4 YoY numbers). Round to 1 digit after the decimal point: e.g. if you get 5.66% growth => you should answer 5.7




"""

end = date.today()
print(f'Year = {end.year}; month= {end.month}; day={end.day}')

start = date(year=2022, month=1, day=1)
print(f'Period for indexes: {start} to {end} ')
# Real Potential Gross Domestic Product (GDPC1), QUARTERLY
# https://fred.stlouisfed.org/series/GDPC1
df_gdpc1 = pdr.DataReader("GDPC1", "fred", start=start)
df_gdpc1

"""![image.png](data:image/png;base64,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)"""

df_gdpc1['GDPC1_yoy']=df_gdpc1['GDPC1']/df_gdpc1['GDPC1'].shift(4)-1
df_gdpc1

"""# **Result Q1.**"""

year_over_year_avg_gdpc1=df_gdpc1.loc['2023']['GDPC1_yoy'].mean()
print(f"The average growth of GDP in 2023 is {year_over_year_avg_gdpc1*100:.1f}%" )

"""# Question 2. [Macro] Inverse "Treasury Yield"
Find the min value of (dgs10-dgs2) after since year 2000 (2000-01-01) and write it down as an answer, round to 1 digit after the decimal point.

Download DGS2 and DGS10 interest rates series (https://fred.stlouisfed.org/series/DGS2, https://fred.stlouisfed.org/series/DGS10). Join them together to one dataframe on date (you might need to read about pandas.DataFrame.join()), calculate the difference dgs10-dgs2 daily.

(Additional: think about what does the "inverted yield curve" mean for the market and investors? do you see the same thing in your country/market of interest? Do you think it can be a good predictive feature for the models?)
"""

end = date(year=2024,month=4,day=9)
# end = date.today()
print(f'Year = {end.year}; month= {end.month}; day={end.day}')

start = date(year=2000, month=1, day=1)
print(f'Period for indexes: {start} to {end} ')

df_dgs2 = pdr.DataReader("DGS2", "fred", start=start)
df_dgs10 = pdr.DataReader("DGS10", "fred", start=start)
df=df_dgs2.join(df_dgs10)
df['dif_daily'] = df['DGS10']-df['DGS2']
df

"""# Result Q2A"""

print(f"The minimun value for DGS2 after 2000 is {df['dif_daily'].min():.1f}")

fig,ax=plt.subplots(nrows=3, ncols=1,figsize=(15,10))
df_plot=df
# df_plot=df.loc['2021-02':'2023-07']
ax[0].plot(df_plot['DGS2'],c='g',label='DGS2')
ax[0].set_title("Treasury Securities at 2-Year ")
ax[1].plot(df_plot['DGS10'],c='b',label='DGS10')
ax[1].set_title("Treasury Securities at 10-Year ")
ax[2].plot(df_plot['dif_daily'],c='y',label='Diff_daily')
ax[1].set_title("Daily difference ")
# plt.ylabel("percent")
# plt.legend(loc="upper right")

"""Looking at the graph, we can see that every time the curve is with a negative trend, it is more profitable to invest for 2 years instead of 10 years.

# *What does the "inverted yield curve" mean for the market and investors? Do you see the same thing in your country/market of interest? Do you think it can be a good predictive feature for the models?*


An "inverted yield curve" means short-term interest rates are higher than long-term rates. It can signal economic concerns and often precedes recessions. This phenomenon occurs globally, not solely in the United States, and is a valuable indicator but is used alongside other factors for predictive models due to its potential limitations.

# Question 3. [Index] Which Index is better recently?
Compare S&P 500 and IPC Mexico indexes by the 5 year growth and write down the largest value as an answer (%)

Download on Yahoo Finance two daily index prices for S&P 500 (^GSPC, https://finance.yahoo.com/quote/%5EGSPC/) and IPC Mexico (^MXX, https://finance.yahoo.com/quote/%5EMXX/). Compare 5Y growth for both (between 2019-04-09 and 2024-04-09). Select the higher growing index and write down the growth in % (closest integer %). E.g. if ratio end/start was 2.0925 (or growth of 109.25%), you need to write down 109 as your answer.

(Additional: think of other indexes and try to download stats and compare the growth? Do create 10Y and 20Y growth stats. What is an average yearly growth rate (CAGR) for each of the indexes you select?)
"""

end = date(year=2024,month=4,day=9)
start = date(year=2019,month=4,day=9)
print(f'Year = {end.year}; month= {end.month}; day={end.day}')

# start = date(year=end.year-5, month=end.month, day=end.day)
print(f'Period for indexes: {start} to {end} ')

# df_sp500 =pd.DataFrame( yf.download(tickers ="^GSPC",start=start,end=end,interval = "1d")['Adj Close'])
# df_mxx= pd.DataFrame(yf.download(tickers = "^MXX",start=start,end=end,interval = "1d")['Adj Close'])
# df_ibex= pd.DataFrame(yf.download(tickers = "^IBEX",start=start,end=end,interval = "1d")['Adj Close'])
# df_eur=pd.DataFrame(yf.download(tickers = "DAX",start=start,end=end,period = "max",interval = "1d")['Adj Close'])
df =yf.download(tickers = ["^GSPC","^MXX","^IBEX","DAX"],start=start,end=end,interval = "1d")['Adj Close']
df

# df_sp500.columns=['SP500']
# df_mxx.columns=['MXX']
# df_ibex.columns=['IBEX']
# df_eur.columns=['EUR']
# df = df_sp500.join(df_mxx).join(df_ibex).join(df_eur)

df.pct_change().cumsum().plot()

columns=df.columns
rates=df.iloc[-1]/df.iloc[0]-1
rate_max=rates.max()
print("5 years rates:")
print("-"*30)
print("index\t rates")
index_max=''
rate_val=0
for col in columns:
  print(f"{col}\t{rates[col]*100:.1f}%")
  if rates[col]>rate_val:
    index_max=col
    rate_val=rates[col]

print()
print("-"*30)
print("")

"""# Result Q3"""

print(f"The higher grouth index is the '{index_max}' with a rate of {rate_max*100:.1f}%")

"""# Question 4. [Stocks OHLCV] 52-weeks range ratio (2023) for the selected stocks
Find the largest range ratio [=(max-min)/max] of Adj.Close prices in 2023

Download the 2023 daily OHLCV data on Yahoo Finance for top6 stocks on earnings (https://companiesmarketcap.com/most-profitable-companies/): 2222.SR,BRK-B, AAPL, MSFT, GOOG, JPM.

Here is the example data you should see in Pandas for "2222.SR": https://finance.yahoo.com/quote/2222.SR/history

Calculate maximum-minimim "Adj.Close" price for each stock and divide it by the maximum "Adj.Close" value. Round the result to two decimal places (e.g. 0.1575 will be 0.16)

(Additional: why this may be important for your research?)


"""

df= yf.download(['2222.SR','BRK-B', 'AAPL', 'MSFT', 'GOOG', 'JPM'],start="2023-01-01",end="2023-12-31")['Adj Close']

"""# Result Q4"""

ll_ratio=dict((df.max()-df.min())/df.max())
print(f'ticker   \t Rate')
for r in ll_ratio :
  print(f'{r}     \t {ll_ratio[r]:.2f}')

"""# Question 5. [Stocks] Dividend Yield
Find the largest dividend yield for the same set of stocks

Use the same list of companies (2222.SR,BRK-B, AAPL, MSFT, GOOG, JPM) and download all dividends paid in 2023. You can use get_actions() method or .dividends field in yfinance library (https://github.com/ranaroussi/yfinance?tab=readme-ov-file#quick-start)

Sum up all dividends paid in 2023 per company and divide each value by the closing price (Adj.Close) at the last trading day of the year.

Find the maximm value in % and round to 1 digit after the decimal point. (E.g., if you obtained $1.25 dividends paid and the end year stock price is $100, the dividend yield is 1.25% -- and your answer should be equal to 1.3)
"""

stocks = ['2222.SR','BRK-B', 'AAPL', 'MSFT', 'GOOG', 'JPM']
df_adj_close = yf.download(stocks,start='2023-12-20',end='2023-12-31',progress=False)['Adj Close']
div_sum_array=[]
for st in stocks:
  div_sum=yf.Ticker(st).dividends.loc['2023'].sum()
  # print(div_sum)
  div_sum_array.append(div_sum)
df=pd.DataFrame(data=div_sum_array,index=stocks,columns=['Dividends'])
df=df.join(df_adj_close.fillna(method='ffill').iloc[-1])
df.columns=['Dividends','Last Year Adj Close']
df['Dividend Yield']=df['Dividends']/df['Last Year Adj Close']
df

"""# Result Q5"""

print("Ticker \tDividend Yield\tMax")
for item,row in df.iterrows():
  print(f'{row.name.ljust(5)}\t {row.get("Dividend Yield")*100:.1f}% ' \
   f'\t\t{"*" if df["Dividend Yield"].max()==row.get("Dividend Yield") else " "}')

"""# Question 6. [Exploratory] Investigate new metrics


Download and explore a few additional metrics or time series that might be valuable for your project and write down why (briefly).

Volatility Measures: Historical and implied volatility help assess risk and
options pricing.

Relative Strength Index (RSI): Indicates overbought/oversold conditions for trading signals.

Moving Averages: Identify trend direction and support/resistance levels.

Volume Analysis: Gauge buying/selling pressure and confirm price trends.

Financial Ratios: Evaluate valuation and financial health of companies.

Correlation Analysis: Assess relationships between assets for diversification and risk management.

Economic Indicators: Impact market sentiment and guide investment decisions.
Sentiment Analysis: Analyze news/social sentiment for market behavior insights.

# Question 7. [Exploratory] Time-driven strategy description around earnings releases

Explore earning dates for the whole month of April - e.g. using YahooFinance earnings calendar (https://finance.yahoo.com/calendar/earnings?from=2024-04-21&to=2024-04-27&day=2024-04-23). Compare with the previous closed earnings (e.g., recent dates with full data https://finance.yahoo.com/calendar/earnings?from=2024-04-07&to=2024-04-13&day=2024-04-08).

Describe an analytical strategy/idea (you're not required to implement it) to select a subset companies of interest based on the future events data.

Data Collection and Analysis:
Gather earnings release dates for April and compare with past periods.
Analyze historical earnings performance, volatility, and sector trends.

Focus Areas:
Focus on sectors with significant price movements and earnings surprises.
Consider sentiment analysis, analyst recommendations, and technical indicators.

Risk Management:
Implement risk controls like stop-loss orders and diversified positions.
Monitor real-time data and adjust strategies accordingly.

Event-Based Screening:
Screen companies based on historical performance and earnings-related factors.
Create a watchlist for potential investment opportunities.
"""